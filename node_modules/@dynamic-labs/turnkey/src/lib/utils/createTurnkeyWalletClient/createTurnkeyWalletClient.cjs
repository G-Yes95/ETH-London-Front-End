'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var viem = require('viem');
var utils = require('@dynamic-labs/utils');
var getGatedTurnkeyAccount = require('../getGatedTurnkeyAccount/getGatedTurnkeyAccount.cjs');
var createRef = require('../createRef/createRef.cjs');
var createTurnkeyTransport = require('../createTurnkeyTransport/createTurnkeyTransport.cjs');

const createTurnkeyWalletClient = ({ account, evmNetwork, rpcUrl, connector, walletUiUtils, }) => {
    const rpcTransport = viem.http(rpcUrl);
    const provider = viem.createPublicClient({ transport: rpcTransport });
    const gatedAccount = getGatedTurnkeyAccount.getGatedTurnkeyAccount({
        account,
        connector,
        provider,
        walletUiUtils: walletUiUtils,
    });
    const chain = utils.getOrMapViemChain(evmNetwork);
    const [getClient, setClient] = createRef.createRef();
    const customTransport = createTurnkeyTransport.createTurnkeyTransport({
        account,
        getClient,
        transport: rpcTransport,
    });
    const client = viem.createWalletClient({
        account: gatedAccount,
        chain,
        transport: customTransport,
    });
    setClient(client);
    return client;
};

exports.createTurnkeyWalletClient = createTurnkeyWalletClient;
